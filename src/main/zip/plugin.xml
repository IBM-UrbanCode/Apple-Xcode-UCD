<?xml version="1.0" encoding="UTF-8"?>
<!--
- Licensed Materials - Property of IBM Corp.
- IBM UrbanCode Deploy
- (c) Copyright IBM Corporation 2011, 2014. All Rights Reserved.
-
- U.S. Government Users Restricted Rights - Use, duplication or disclosure restricted by
- GSA ADP Schedule Contract with IBM Corp.
-->
<plugin xmlns="http://www.urbancode.com/PluginXMLSchema_v1"
        xmlns:server="http://www.urbancode.com/PluginServerXMLSchema_v1"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <header>
    <identifier id="com.urbancode.air.plugin.pluginName" name="Plugin Name" version="1"/>
    <description>
        Provides mobile support for working with iOS.
        Refer to the ios_plugin.pdf file, which is embedded in the plug-in .zip file for more documentation.
    </description>
    <tag>Mobile/iOS</tag>
    <server:required-server-version>6.0.1.0</server:required-server-version>
  </header>
  
  <!-- Simulator based steps -->

  <step-type name="Start Simulator">
    <description>
        Starts a simulator. The step fails if a simulator is already running.
    </description>
    <properties>
      <property name="deviceType">
        <property-ui type="textBox"
                     label="Device Type"
                     description="The simulator device type, for example, iPad or iPhone."/>
      </property>
      <property name="targetOS">
        <property-ui type="textBox"
                     label="Target OS"
                     description="The target OS or SDK version, for example, 6.1 or 7.1."/>
      </property>
      <property name="xcode">
        <property-ui type="textBox"
                     label="Path To Xcode"
                     description="The path to the Xcode.app installation."
                     default-value="${p?:resource/XcodePath}"
                     hidden="true"/>
      </property>
    </properties>
    <post-processing><![CDATA[
        if (properties.get("exitCode") != 0) {
            properties.put(new java.lang.String("Status"), new java.lang.String("Failure"));
        }
        else {
            properties.put("Status", "Success");
        }
     ]]></post-processing>
    <command program="${GROOVY_HOME}/bin/groovy">
      <arg value="-cp"/>
      <arg path="classes"/>
      <arg file="startSimulator.groovy"/>
      <arg file="${PLUGIN_INPUT_PROPS}"/>
      <arg file="${PLUGIN_OUTPUT_PROPS}"/>
    </command>
  </step-type>
  
  <step-type name="Stop Simulator">
    <description>
        Stops the running simulator. The step fails if no simulator is running.
    </description>
    <properties/>
    <post-processing><![CDATA[
        if (properties.get("exitCode") != 0) {
            properties.put(new java.lang.String("Status"), new java.lang.String("Failure"));
        }
        else {
            properties.put("Status", "Success");
        }
     ]]></post-processing>
    <command program="${GROOVY_HOME}/bin/groovy">
      <arg value="-cp"/>
      <arg path="classes"/>
      <arg file="stopSimulator.groovy"/>
      <arg file="${PLUGIN_INPUT_PROPS}"/>
      <arg file="${PLUGIN_OUTPUT_PROPS}"/>
    </command>
  </step-type>
</plugin>
